version: 0.3

// Panel with ninepatch background that auto-sizes based on item count
#flowPanel programmable(count:uint=3) {
  flow(layout:vertical, padding:3, verticalSpacing:1, background:ninepatch("ui", "Window_3x3_idle")) {
    repeatable($i, step($count, dx:0)) {
      bitmap(generated(color(25, 8, #885544)));
    }
  }
}

#flowBgDemo programmable() {
  pos: 0, 0

  @scale(4) point {
    pos: 5, 5

    // Row 1: Different counts - background scales with content
    point {
      pos: 0, 0
      text(m3x6, "count:2", #888, left, 200);
      point {
        pos: 0, 10
        reference($flowPanel, count=>2);
      }
    }

    point {
      pos: 80, 0
      text(m3x6, "count:4", #888, left, 200);
      point {
        pos: 0, 10
        reference($flowPanel, count=>4);
      }
    }

    point {
      pos: 160, 0
      text(m3x6, "count:6", #888, left, 200);
      point {
        pos: 0, 10
        reference($flowPanel, count=>6);
      }
    }

    // Row 2: Different flow layouts with background
    point {
      pos: 0, 80
      text(m3x6, "horizontal", #888, left, 200);
      point {
        pos: 0, 10
        flow(layout:horizontal, padding:4, horizontalSpacing:2, background:ninepatch("ui", "Window_3x3_idle")) {
          bitmap(generated(color(15, 15, #ff4444)));
          bitmap(generated(color(15, 15, #44ff44)));
          bitmap(generated(color(15, 15, #4444ff)));
        }
      }
    }

    point {
      pos: 120, 80
      text(m3x6, "multiline", #888, left, 200);
      point {
        pos: 0, 10
        flow(maxWidth:60, layout:horizontal, multiline:true, padding:3, horizontalSpacing:1, verticalSpacing:1, background:ninepatch("ui", "Window_3x3_idle")) {
          bitmap(generated(color(12, 12, #ff4444)));
          bitmap(generated(color(12, 12, #44ff44)));
          bitmap(generated(color(12, 12, #4444ff)));
          bitmap(generated(color(12, 12, #ffff44)));
          bitmap(generated(color(12, 12, #ff44ff)));
        }
      }
    }

    point {
      pos: 220, 80
      text(m3x6, "padding:8", #888, left, 200);
      point {
        pos: 0, 10
        flow(layout:vertical, padding:8, verticalSpacing:2, background:ninepatch("ui", "Window_3x3_idle")) {
          bitmap(generated(color(30, 10, #ff8844)));
          bitmap(generated(color(30, 10, #88ff44)));
        }
      }
    }
  }
}
